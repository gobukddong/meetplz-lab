---
alwaysApply: true
---

---
description: Next.js App Router, Supabase, TypeScript 사용 시의 코딩 표준 및 Best Practices를 정의합니다.
globs: **/*.ts, **/*.tsx
---

# Tech Stack & Coding Standards

## 1. Framework & Language
- **Next.js 14+ (App Router)**: 모든 페이지는 `app/` 디렉토리에 위치합니다.
- **TypeScript**: Strict 모드를 사용하며, `any` 사용을 지양하고 인터페이스를 명확히 정의합니다.
- **Server Actions**: 데이터 변형(Mutation)은 반드시 Server Actions를 사용합니다. API Routes는 필요한 경우에만 제한적으로 사용합니다.

## 2. Supabase & Database
- **Supabase SSR**: `@supabase/ssr` 패키지를 사용하여 클라이언트/서버 컴포넌트 간 세션을 관리합니다.
- **RLS (Row Level Security)**: 모든 테이블에는 RLS 정책이 적용되어야 합니다. 서비스 로직에서 `supabase.auth.getUser()`로 검증 후 쿼리를 실행하세요.
- **Type Generation**: Supabase의 Database 타입을 자동으로 생성하여 사용합니다 (`Database` 인터페이스 활용).

## 3. Data Fetching & State Management
- **Server Components**: 가능한 경우 서버 컴포넌트에서 데이터를 직접 페칭하여 클라이언트로 전달합니다.
- **Optimistic UI**: 할 일 생성, 좋아요, 모임 참여 등 사용자의 즉각적인 반응이 필요한 곳에는 `useOptimistic` 또는 유사한 패턴을 적용합니다.
- **React Query**: 필요한 경우 클라이언트 사이드 데이터 캐싱에 사용하되, Next.js의 기본 캐싱과 충돌하지 않도록 주의합니다.

## 4. Project Structure (Best Practice)
- `/app`: 라우팅 및 페이지
- `/components`: 재사용 가능한 UI 컴포넌트
- `/lib`: 유틸리티 함수, Supabase 클라이언트 설정
- `/actions`: Server Actions (비즈니스 로직 포함)
- `/types`: 전역 타입 정의

## 5. Error Handling
- Server Actions에서 에러 발생 시 명확한 `message`와 함께 객체를 반환하여 클라이언트에서 토스트 메시지 등으로 처리할 수 있게 합니다.
- `try/catch` 블록을 사용하여 DB 요청 실패를 우아하게 처리합니다.